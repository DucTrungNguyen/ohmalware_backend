# Author: Duc Trung Nguyen
# Created: 11/04/2021
# Project: ohmalware_backend
import store
import numpy as np
from sklearn.metrics import classification_report


def detect_single_app(final_futures):
    try:
        x_test_deep = np.array(final_futures[:28 * 28])
        x_test_wide = np.array(final_futures[28 * 28:])
        x_test_wide = x_test_wide.reshape(-1, 445)
        # print(x_test_wide.shape)
        # print(x_test_deep.shape)
        # print(store.model_wide_deep.summary())
        test_logit = store.model_wide_deep.predict([x_test_wide, x_test_deep.reshape(-1, 28, 28, 1)])
        y_pred = np.argmax(test_logit, axis=-1)
        # print('detect_single_app', y_pred)

        return y_pred
    except Exception as e:
        print(e)
    # report = classification_report(y_test, y_pred, output_dict=True)
    # report = classification_report(y_test, y_pred)
