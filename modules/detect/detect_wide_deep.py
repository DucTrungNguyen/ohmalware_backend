# Author: Duc Trung Nguyen
# Created: 11/04/2021
# Project: ohmalware_backend
import store
import numpy as np
from sklearn.metrics import classification_report


def detect_single_app(final_futures):
    x_test_deep = np.array(final_futures[:1024])
    x_test_wide = np.array(final_futures[1024:])

    test_logit = store.model_wide_deep.predict([x_test_wide.reshape(1, 811), x_test_deep.reshape(1, 32, 32, 1)])

    test_logit = np.argmax(test_logit, axis=1)
    return test_logit
    # print(test_logit)
