# Author: Duc Trung Nguyen
# Created: 11/04/2021
# Project: ohmalware_backend
import store
import numpy as np
from sklearn.metrics import classification_report


def detect_single_app(final_futures):
    x_test_deep = final_futures[:1024]
    x_test_wide = final_futures[1024:]
    test_logit = store.model_wide_deep.predict([x_test_wide, x_test_deep.reshape(x_test_deep.shape[0], 32, 32, 1)])
    y_pred = np.argmax(test_logit, axis=-1)
    # report = classification_report(y_test, y_pred, output_dict=True)
    # report = classification_report(y_test, y_pred)