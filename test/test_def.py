# Author: Duc Trung Nguyen
# Created: 09/04/2021
# Project: ohmalware_backend
import unittest
import keras
import numpy as np


class TestDef(unittest.TestCase):
    def test_read_struct_future(self):
        with open('../modules/reverse/info/struct_futures.txt', 'r') as f:
            data = f.read()
            a = data.replace(' ', '').replace('"', '').split(',')
            print(len(a))
            b = 1

    def test_read_struct_future(self):
        model = keras.models.load_model(
            '/Users/technixo/PycharmProjects/ohmalware_backend/modules/detect/wide_deep/wide_deep.h5')

        feature = 1835 * [0]

        x_test_deep = np.array(feature[:1024])
        # wide  = feature[1024:]
        # print(len(wide))

        x_test_wide = np.array(feature[1024:])

        test_logit = model.predict([x_test_wide.reshape(1, 811), x_test_deep.reshape(1, 32, 32, 1)])

        test_logit = np.argmax(test_logit, axis=1)
        print(test_logit)
        # print(test_logit)
        # print('before')
        # test_logit = np.argmax(test_logit, axis=1)
